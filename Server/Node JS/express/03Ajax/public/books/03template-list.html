<!--  Attempt #2 (template tag) at trying to remove unnecessary fetch of in page template.  -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ajax Version</title>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            padding: 5px;
        }
        a { cursor: pointer; color: blue; }
        a:hover,a.hover { text-decoration: underline; }
    </style>
</head>
<body>
<a href="/logout">Logout</a><br><br>
<div id="display"></div>


<script   src="https://code.jquery.com/jquery-2.2.3.min.js"   integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="   crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function(event) {
        loadBooks();
    });

    function loadBooks(){
         $.get('/api/books/', function(books) {
             var table = document.querySelector('#list');
             var parent = document.importNode(table.content, true);

             for (var i = 0; i < books.length; i ++) {
                 var book = books[i];

                 var row = parent.querySelector('template');
                 var newRow = document.importNode(row.content, true);
                 var cells = newRow.querySelectorAll('td');

                 cells[0].textContent = book.id;
                 cells[1].textContent = book.title;
                 cells[2].textContent = book.author;
                 cells[3].textContent = book.price;

                 row.parentNode.appendChild(newRow);
             }

             document.getElementById('display').appendChild(parent);
        });
    }

</script>

<!-- New stuff isn't always easier -->
<template id="list">
    <table>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Author</th>
            <th>Price</th>

        </tr>
        <template id="row">
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </template>

    </table>


</template>

</body>
</html>